System.register(["./chunk-frameworks.js","./chunk-vendor.js"],function(){"use strict";var i,a;return{setters:[function(n){i=n.w},function(n){a=n.o}],execute:function(){var n=Object.defineProperty,u=(o,t)=>n(o,"name",{value:t,configurable:!0});const m=u(async(o,t,e,s)=>{const r=new FormData;return s===!0&&r.append("upvote","true"),await fetch(o,{body:e==="delete"?"":r,method:e,mode:"same-origin",headers:{"Scoped-CSRF-Token":t}})},"sendRequest");class l{constructor(t){this.voteCountElement=t}getLabel(){var t;return((t=this.voteCountElement)==null?void 0:t.getAttribute("data-upvote-label"))||""}getText(){var t;return((t=this.voteCountElement)==null?void 0:t.textContent)||""}}u(l,"VoteCountElement");class v{constructor(t){this.voteForm=t,this.voteButton=this.voteForm.querySelector(".js-upvote-button"),this.defaultVoteCountElement=new l(t.querySelector(".js-default-vote-count")),this.upvotedCountElement=new l(t.querySelector(".js-upvoted-vote-count")),this.url=this.voteForm.getAttribute("data-url")||""}isUpvoted(){return this.voteForm.getAttribute("data-upvoted")==="true"}getCsrfDeleteInputValue(){const t=this.voteForm.querySelector(".js-data-url-delete-csrf");return t?t.value:""}getCsrfPutInputValue(){const t=this.voteForm.querySelector(".js-data-url-put-csrf");return t?t.value:""}simulateUpvote(){var t,e,s,r;this.voteForm.setAttribute("data-upvoted","true"),this.voteForm.getAttribute("data-new-upvote")&&((t=this.voteForm.querySelector(".js-upvote-button"))==null||t.classList.add("user-has-reacted","color-bg-accent"),(e=this.voteForm.querySelector(".js-upvote-button"))==null||e.classList.remove("color-fg-muted")),this.voteForm.classList.add("is-upvoted"),(s=this.voteButton)==null||s.setAttribute("aria-label",this.upvotedCountElement.getLabel()),(r=this.voteButton)==null||r.setAttribute("aria-pressed","true"),i(`${this.upvotedCountElement.getText()} Upvotes`)}simulateUpvoteDeletion(){var t,e,s,r;this.voteForm.setAttribute("data-upvoted","false"),this.voteForm.getAttribute("data-new-upvote")&&((t=this.voteForm.querySelector(".js-upvote-button"))==null||t.classList.remove("user-has-reacted","color-bg-accent"),(e=this.voteForm.querySelector(".js-upvote-button"))==null||e.classList.add("color-fg-muted")),this.voteForm.classList.remove("is-upvoted"),(s=this.voteButton)==null||s.setAttribute("aria-label",this.defaultVoteCountElement.getLabel()),(r=this.voteButton)==null||r.setAttribute("aria-pressed","false"),i(`${this.defaultVoteCountElement.getText()} Upvotes`)}displayUpVoteError(t){const e=this.voteForm.querySelector(".js-upvote-error");e instanceof HTMLElement&&(e.textContent=t,e.hidden=!1)}hideVoteErrors(){const t=this.voteForm.querySelector(".js-upvote-error");t instanceof HTMLElement&&(t.hidden=!0)}}u(v,"VoteFormElement");class c{constructor(t){this.voteFormElement=t}animateUpvote(t){t?this.voteFormElement.simulateUpvoteDeletion():this.voteFormElement.simulateUpvote()}animateUpvoteUndo(t){t?this.voteFormElement.simulateUpvote():this.voteFormElement.simulateUpvoteDeletion()}async click(){this.voteFormElement.hideVoteErrors();const t=this.voteFormElement.isUpvoted(),e=t?this.voteFormElement.getCsrfDeleteInputValue():this.voteFormElement.getCsrfPutInputValue(),s=t?"delete":"put";this.animateUpvote(t);const r=await m(this.voteFormElement.url,e,s,!t);if(!r.ok){const d=await r.json();this.voteFormElement.displayUpVoteError(d.error),this.animateUpvoteUndo(t)}}}u(c,"Upvote"),a(".js-upvote-button",o=>{if(!(o instanceof HTMLElement)||!(o.parentElement instanceof HTMLElement))return;const t=new c(new v(o.parentElement));o.addEventListener("click",async()=>{await t.click()})})}}});
//# sourceMappingURL=chunk-voting-3f26627e.js.map
